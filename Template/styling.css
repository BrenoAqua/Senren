/* Fonts */
@import url("https://fonts.googleapis.com/css2?family=Klee+One:wght@400;600&family=Noto+Sans+JP:wght@100..900&family=Noto+Serif+JP:wght@200..900&display=swap");

@font-face {
  font-family: klee;
  src: url("_KleeOne-SemiBold.ttf");
}

@font-face {
  font-family: notosansjp;
  src: url("_NotoSansJP.ttf");
}

@font-face {
  font-family: notoserifjp;
  src: url("_NotoSerifJP.ttf");
}

/* Custom Variables for Styling */
:root {
  /* ===== BASE SETTINGS ===== */
  /* Global */
  font-size: clamp(20px, 4vw, 25px);
  --base-line-height: 1.5;
  --base-padding: 20px;
  --base-transition: 0.3s ease;
  
  /* Fonts */
  --sans: hiragino kaku gothic proN, notosansjp, Noto Sans JP;
  --serif: klee, Klee One SemiBold, notoserifjp, Noto Serif JP;
  
  /* ===== COLORS ===== */
  /* Theme Colors */
  --light-bg: white;
  --light-text: black;
  --dark-bg: black;
  --dark-text: white;
  
  /* Pitch Accent Colors */
  --pitch-red: #fd5c5c;
  --pitch-blue: #89daff;
  --pitch-orange: #fca311;
  --pitch-green: #4e937a;
  --pitch-purple: #afa2ff;

  /* Devoiced Mora Color */
  --devoiced-color: royalblue;

  /* Highlight Colors */
  --dark-mode-highlight: #FCFF61;
  --light-mode-highlight: #E20033;
  
  /* ===== NIGHT MODE BACKGROUND COLORS ===== */
  --card-bg: rgba(0,0,0,0.4);
  --buttons-bg: rgba(0,0,0,0.1);
  --buttons-bg-hover: rgba(0, 0, 0, 0.63);
  --lightbox-bg: rgba(0, 0, 0, 0.8);
  --frequency-bg-light: rgba(0, 0, 0, 1);
  --frequency-bg-dark: rgba(0, 0, 0, 0.63);
  
  /* ===== TEXT COLORS ===== */
  --text-color-light: rgba(105, 105, 105, 0.3);
  --text-color-dark: rgba(255, 255, 255, 0.2);
  --text-color-muted: rgba(105, 105, 105, 0.3);
  --text-color-muted-dark: rgba(255, 255, 255, 0.5);
  
  /* ===== LAYOUT & SPACING ===== */
  /* Spacing Scale */
  --spacing-xs: 2px;
  --spacing-sm: 3px;
  --spacing-ms: 8px;
  --spacing-md: 10px;
  --spacing-lg: 15px;
  --spacing-xl: 20px;
  --spacing-xxl: 24px;
  --spacing-xxml: 27px;
  --spacing-xxxl: 34px;
  
  /* Layout Components */
  --card-max-width: 800px;
  --front-top-offset: 100px;
  --back-top-offset: 26px;
  --grid-gap: var(--spacing-xl);
  --grid-column-min-width: 390px;
  
  /* Component Sizes */
  --button-size: 20px;
  --toggle-width-large: 60px;
  --toggle-width-medium: 20px;
  --picture-height: 219px;
  --lightbox-nav-width: 100px;
  --background-box-min-height: 150px;

  /* Border Radius */
  --border-radius-sm: 4px;
  --border-radius-ms: 5px;
  --border-radius-md: 10px;
  --border-radius-lg: 12px;
  
  /* ===== TYPOGRAPHY ===== */
  /* Word Sizes */
  --word-size-base: 2.5rem;
  --word-size-6: 2.2rem; /* For 6-character words */
  --word-size-7: 1.9rem; /* For 7-character words */
  --word-size-8: 1.8rem; /* For 8-character words */
  --word-size-9: 1.7rem; /* For 9-character words */
  
  /* Sentence Sizes */
  --sentence-size: 1.3rem;
  --sentence-eng-size: 0.8rem;
  
  /* Definition Size */
  --definition-size: 0.8rem;
  
  /* Misc Info Size */
  --misc-info-size: 15px;
  
  /* Frequency Sizes */
  --frequency-size: 20px;
  --frequency-content-size: 14px;
  --frequency-max-height: 500px;

  /* Dictionary Title */
  --definition-title-visibility: block; /* 'none' to hide */
  --glossary-title-visibility: block; /* 'none' to hide */
  --dict-size: 0.5rem;
  --dict-display: inline-block;
  --dict-color: rgba(255, 255, 255, 0.4);
  
  /* ===== TAG STYLING ===== */
  --tag-visibility: flex; /* 'none' to hide */
  --tag-font-size: 0.7rem;
  --tag-padding: 5px 10px;
  --tag-margin-top: 10px;
  --tag-margin-bottom: 0;
  --tag-border-radius: 5px;
  --tag-bg: var(--card-bg);
  --tag-color: white;
  --tags-container-gap: 10px;
  
  /* ===== EFFECTS & ANIMATIONS ===== */
  /* Shadows */
  --button-shadow: 0 0 5px 2.5px rgba(0, 0, 0, 0.3);
  --button-shadow-dark: 0 0 5px 2.5px rgba(255, 255, 255, 0.3);
  --lightbox-shadow: 0 1px 8px rgba(0, 0, 0, 0.15);
  
  /* Z-index Layers */
  --z-index-base: 1;
  --z-index-toggle: 2;
  --z-index-lightbox: 1000;
  }

  /* ===== RESPONSIVE DESIGN ===== */
  /* Large Screens */
  @media (max-width: 1200px) {
  :root {
    /* Buttons Visibility */
    --button-visibility-large: visible; /* 'hidden' to hide */
    --freq-visibility-large: visible; /* 'hidden' to hide */

    /* Grid Columns */
    --grid-columns-large: repeat(2, 1fr); /* Two columns */
    }
  }

  /* Medium Screens */
  @media (max-width: 768px) {
  :root {
    /* Buttons Visibility */
    --button-visibility-medium: visible; /* 'hidden' to hide */
    --freq-visibility-medium: visible; /* 'hidden' to hide */

    /* Grid Columns */
    --grid-columns-medium: repeat(2, 1fr); /* Two columns */
    }
  }

  /* Small Screens */
  @media (max-width: 624px) {
  :root {
    /* Buttons Visibility */
    --button-visibility-small: visible; /* 'hidden' to hide */
    --freq-visibility-small: visible; /* 'hidden' to hide */

    /* Grid Columns */
    --grid-columns-small: repeat(1, 1fr); /* One column */

    /* Picture Height */
    --picture-height-small: 320px; /* Max picture height */
    --picture-max-height-small: 100%; /* Max picture img height */
  }
}

/* Card Layout */
.front, .back {
  position: relative;
  padding: var(--base-padding);
  max-width: var(--card-max-width);
  margin: 0 auto;
}

.front { top: var(--front-top-offset); }
.back { top: var(--back-top-offset); }

.front::before, .back::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: var(--border-radius-lg);
  z-index: -1;
}

.card.nightMode .front::before, .card.nightMode .back::before {
  background-color: var(--card-bg);
}

/* Platform Specific */
.win, .mac, .linux, .mobile {
  text-align: center;
  display: block;
  width: 100%;
  margin: auto;
}

/* Card Base */
.card {
  display: unset;
  font-family: var(--sans);
  text-align: center;
  position: relative;
}

.card-a rt li {
  display: inline;
  font-size: 1rem;
  font-weight: normal;
}

.card-b {
  font-size: var(--definition-size);
}

.card-b li {
  list-style: none !important;
}

/* Hyperlinks */
a {
  color: currentColor;
  text-decoration: none;
}

/* Highlight Text */
b, strong {
  color: var(--light-mode-highlight);
  font-weight: normal;
}

.custom-dark-mode b, strong, .card.nightMode b, strong {
  color: var(--dark-mode-highlight);
}

.highlight {
  color: var(--light-mode-highlight);
  padding: var(--spacing-ms) var(--spacing-sm) var(--spacing-xs);
  margin: 0 var(--spacing-sm);
}

.custom-dark-mode .highlight, .card.nightMode .highlight {
  color: var(--dark-mode-highlight);
}

/* List Style */
ul, ol {
  list-style: none;
  padding-left: 0;
  display: inline;
}

/* Custom Dark Mode */
.custom-dark-mode {
  background-color: var(--dark-bg) !important;
  color: var(--dark-text) !important;
}

/* Dark Mode Toggle */
.toggle-custom-dark-mode {
  position: fixed;
  top: var(--spacing-xxl);
  left: var(--spacing-xxxl);
  padding: var(--spacing-ms) var(--spacing-lg);
  color: var(--text-color-muted);
  cursor: pointer;
  border: none;
  border-radius: var(--border-radius-ms);
  font-size: var(--button-size);
  display: flex;
  justify-content: center;
  align-items: center;
  transition: box-shadow var(--base-transition), background-color var(--base-transition), color var(--base-transition);
  z-index: var(--z-index-base);
}

.toggle-custom-dark-mode:hover {
  box-shadow: var(--button-shadow);
  background: var(--dark-bg);
  color: var(--dark-text);
}

.custom-dark-mode .toggle-custom-dark-mode, .card.nightMode .toggle-custom-dark-mode {
  background: var(--buttons-bg); 
}

.card.nightMode .toggle-custom-dark-mode:hover {
  box-shadow: var(--button-shadow);
  background: var(--buttons-bg-hover);
  color: var(--dark-text);
}

.custom-dark-mode .toggle-custom-dark-mode.dark-mode:hover {
  box-shadow: var(--button-shadow-dark);
  background: var(--light-bg);
  color: var(--light-text);
}

/* Word + Grid Settings */
#word li:not(:first-child) {
  display: none;
}

#word {
  position: relative;
  font-family: var(--serif);
  font-size: var(--word-size-base);
  text-align: center;
}

#word.length-6 { font-size: var(--word-size-6); }
#word.length-7 { font-size: var(--word-size-7); }
#word.length-8 { font-size: var(--word-size-8); }
#word.length-9 { font-size: var(--word-size-9); }

#word ruby rt {
  font-family: var(--sans);
}

.grid-container {
  display: grid;
  grid-template-columns: minmax(var(--grid-column-min-width), 1fr) auto;
  gap: var(--grid-gap);
  align-items: stretch;
}

.grid-container:not(:has(> .picture-container > img)) {
  grid-template-columns: repeat(1, 1fr);
}

.background-box {
  position: relative;
  overflow: hidden;
  padding: var(--spacing-ms);
  border-radius: var(--border-radius-ms);
  display: flex;
  justify-content: center;
  align-items: center;
  white-space: nowrap;
  min-width: min-content;
  min-height: var(--background-box-min-height);
}

.card.nightMode .background-box {
  background: var(--card-bg);
}

/* Picture Container */
img {
  max-width: 100%;
  height: auto;
}

.lightbox img {
  position: relative;
  max-width: 80%;
  max-height: 80%;
  box-shadow: var(--lightbox-shadow);
  transition: transform var(--base-transition);
}

.lightbox {
  position: fixed;
  inset: 0;
  background: var(--lightbox-bg);
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  visibility: hidden;
  transition: opacity var(--base-transition), visibility var(--base-transition);
  z-index: var(--z-index-lightbox);
}

.lightbox.active {
  opacity: 1;
  visibility: visible;
}

.picture-container {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  background: var(--card-bg);
  border-radius: var(--border-radius-ms);
  overflow: hidden;
}

.picture-container img {
  display: none;
  max-width: 100%;
  max-height: var(--picture-height);
  min-height: var(--picture-height);
  object-fit: cover;
  cursor: pointer;
  user-select: none;
}

.picture-container img:first-of-type {
  display: block;
}

/* Navigation Arrows */
.nav-arrow {
  position: absolute;
  width: 50px;
  height: 100%;
  border-radius: var(--border-radius-ms);
  background-color: rgba(0, 0, 0, 0.5);
  cursor: pointer;
  opacity: 0;
  transition: opacity var(--base-transition);
}

.nav-arrow.hidden {
  display: none;
}

.nav-arrow:hover {
  opacity: 1;
}

.nav-arrow.left {
  left: 0; 
  -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,1), rgba(0,0,0,0));
}

.nav-arrow.right {
  right: 0; 
  -webkit-mask-image: linear-gradient(to left, rgba(0,0,0,1), rgba(0,0,0,0));
}

/* Lightbox Navigation */
.lightbox .lightbox-nav {
  position: absolute;
  width: var(--lightbox-nav-width);
  height: 100%;
  background-color: rgba(255,255,255,0.05);
  cursor: pointer;
  opacity: 0;
  transition: opacity var(--base-transition);
}

.lightbox-nav.hidden {
  display: none;
}

.lightbox .lightbox-nav:hover {
  opacity: 1;
}

.lightbox .lightbox-nav.left {
  left: 0; 
  -webkit-mask-image: linear-gradient(to right, rgba(255,255,255,1), rgba(0,0,0,0));
}

.lightbox .lightbox-nav.right {
  right: 0; 
  -webkit-mask-image: linear-gradient(to left, rgba(255,255,255,1), rgba(0,0,0,0));
}

/* Lightbox Grid Toggle */
.lightbox-grid-toggle {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px 20px;
  background: rgba(0,0,0,0.2);
  color: rgba(255,255,255,0.4);
  border: none;
  cursor: pointer;
  z-index: 1001;
  transition: background var(--base-transition), color var(--base-transition);
}

.lightbox-grid-toggle:hover {
  color: white;
  background: rgba(0,0,0,0.7);
  border: none;
}

/* Lightbox Grid View */
.lightbox-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 10px;
  padding: 20px;
  width: 90%;
  height: 80%;
  margin: 0 auto;
  place-items: center;
  overflow: hidden;
}

.lightbox-grid img {
  max-width: 100%;
  max-height: 150px;
  width: auto;
  height: auto;
  object-fit: contain;
  cursor: pointer;
  transition: transform 0.2s;
}

.lightbox-grid img:hover {
  transform: scale(1.05);
}

/* NSFW Content */
.NSFW {
  overflow: hidden;
  border-radius: var(--border-radius-md); 
}

.NSFW img {
  filter: blur(20px);
  transition: filter var(--base-transition);
}

.NSFW img.clicked {
  filter: blur(0);
}

/* Sentence */
.sentence-container {
  margin: var(--spacing-xl) 0;
  text-align: center; 
  direction: rtl; 
  unicode-bidi: bidi-override; 
  margin-left: 5px;
  margin-right: 5px;
}

#sentence {
  font-size: var(--sentence-size);
  display: inline-block; 
  direction: ltr;
  unicode-bidi: normal; 
  text-align: left;
}

#sentence rt {
  opacity: 0;
  transition: opacity var(--base-transition);
}

#sentence ruby:hover rt {
  opacity: 1;
}

#sentenceEng {
  font-size: var(--sentence-eng-size);
  max-height: 0;
  overflow: hidden;
  will-change: max-height;
  display: flex;
  justify-content: center;
  transition: max-height var(--base-transition);
  direction: ltr;
  unicode-bidi: normal;
  text-align: left;
}

#sentenceEng:has(> b) {
  text-align: center;
  display: block;
}

/* Definition + Glossary */
#glossary {
  display: grid;
  place-items: left;
  text-align: center;
  line-height: var(--base-line-height);
}

#definition, #glossary {
  position: relative;
  display: none;
}

#definition.show, #glossary.show {
  display: block;
}

.glossary-box, .definition-box {
  position: relative;
  padding: var(--spacing-lg); 
  border-radius: var(--border-radius-ms);
  will-change: transform;
}

.card.nightMode .glossary-box, .card.nightMode .definition-box {
  background: var(--card-bg);
}

/* Toggle Areas */
.toggle-area {
  position: absolute;
  top: 0;
  bottom: 0;
  width: var(--toggle-width-medium);
  background-color: rgba(0, 0, 0, 0.8);
  z-index: var(--z-index-toggle);
  opacity: 0;
  border-radius: var(--border-radius-ms);
  cursor: pointer;
  transition: opacity var(--base-transition);
}

.custom-dark-mode .toggle-area, .card.nightMode .toggle-area {
  background-color: rgba(255, 255, 255, 0.8);
}

.toggle-area:hover {
  opacity: 1;
}

.toggle-area.left { left: -20px; }
.toggle-area.right { right: -20px; }

/* Toggle Areas Larger */
.toggle-area.left-larger,
.toggle-area.right-larger {
  opacity: 0;
  width: var(--toggle-width-large);
  transition: opacity var(--base-transition);
}

.toggle-area.left-larger {
  left: -20px;
  -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,1), rgba(0,0,0,0));
}

.toggle-area.right-larger {
  right: -20px;
  -webkit-mask-image: linear-gradient(to left, rgba(0,0,0,1), rgba(0,0,0,0));
}

.toggle-area.left-larger:hover,
.toggle-area.right-larger:hover {
  opacity: 0.1;
}

.toggle-area.left-larger:hover ~ .toggle-area.left:not(.left-larger):not(.right-larger),
.toggle-area.right-larger:hover ~ .toggle-area.right:not(.left-larger):not(.right-larger) {
  opacity: 1;
}

/* Audio */
.audio, .sentenceaudio, .playImage path {
  position: fixed;
  width: var(--button-size);
  height: var(--button-size);
  top: 74px;
  left: var(--spacing-xxxl);
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: var(--border-radius-ms);
  padding: var(--spacing-ms) var(--spacing-lg);
  cursor: pointer;
  transition: box-shadow var(--base-transition), background-color var(--base-transition), fill var(--base-transition);
}

.custom-dark-mode .audio, .card.nightMode .audio, 
.custom-dark-mode .sentenceaudio, .card.nightMode .sentenceaudio {
  background: var(--buttons-bg);
}

.sentenceaudio {
  top: 124px;
}

.back:not(:has(.audio)) .sentenceaudio {
  top: 74px;
}

.audio:hover, 
.sentenceaudio:hover, 
.audio:hover .playImage path, 
.sentenceaudio:hover .playImage path {
  box-shadow: var(--button-shadow);
  background: var(--dark-bg) !important;
  fill: var(--dark-text) !important;
}

.card.nightMode .audio:hover, 
.card.nightMode .sentenceaudio:hover, 
.card.nightMode .audio:hover .playImage path, 
.card.nightMode .sentenceaudio:hover .playImage path {
  background: var(--buttons-bg-hover) !important;
}

.audio.dark-mode:hover,
.sentenceaudio.dark-mode:hover,
.audio.dark-mode:hover .playImage path,
.sentenceaudio.dark-mode:hover .playImage path {
  box-shadow: var(--button-shadow-dark);
  background: var(--light-bg) !important;
  fill: var(--light-text) !important;
}

.audio circle, .sentenceaudio circle {
  display: none;
}

.playImage path {
  fill: var(--text-color-muted) !important;
}

/* Pitch Accent Colors */
.pitch .heiban span[style*="border-color:currentColor"] { color: var(--pitch-blue); }
.pitch .atamadaka span[style*="border-color:currentColor"] { color: var(--pitch-red); }
.pitch .nakadaka span[style*="border-color:currentColor"] { color: var(--pitch-orange); }
.pitch .odaka span[style*="border-color:currentColor"] { color: var(--pitch-green); }
.pitch .kifuku span[style*="border-color:currentColor"] { color: var(--pitch-purple); }

.pitch .heiban #position { background-color: rgba(137, 218, 255, 0.5); }
.pitch .atamadaka #position { background-color: rgba(253, 92, 92, 0.5); }
.pitch .nakadaka #position { background-color: rgba(252, 163, 17, 0.5); }
.pitch .odaka #position { background-color: rgba(78, 147, 122, 0.5); }
.pitch .kifuku #position { background-color: rgba(175, 162, 255, 0.5); }

/* Hide ALL Dotted Circles */
span[style*="border:1.5px dotted #c83c28"] {
    display: none !important;
}

/* Paint the devoiced mora */
span[style*="display:inline-block;position:relative;"] > span[style*="display:inline"]:has(+ span[style*="border:1.5px dotted #c83c28"]) {
    color: var(--devoiced-color) !important;
}

/* Pitch Position */
#position {
  font-family: var(--sans);
  position: absolute;
  top: 0;
  left: 100%;
  margin-left: var(--spacing-ms);
  font-size: 0.48rem;
  padding: 0 var(--spacing-xs);
  border-radius: 4px;
  color: var(--text-color-muted);
  z-index: var(--z-index-base);
  text-align: center;
  line-height: 16px;
}

.custom-dark-mode #position,
.card.nightMode #position {
  color: var(--text-color-muted-dark);
}

#position:empty {
  display: none;
}

#position ol li:first-child span span {
  display: none;
}

#position ol li:first-child span span:nth-child(2) {
  display: inline;
}

#position > span > span:nth-child(1),
#position > span > span:nth-child(3) {
  display: none;
}

/* Pitch Categories */
#categories {
  font-family: var(--sans);
  position: absolute;
  top: 0;
  left: 100%;
  margin-left: var(--spacing-ms);
  font-size: 12px;
  padding: 0 var(--spacing-xs);
  border-radius: var(--border-radius-sm);
  color: var(--text-color-muted);
  z-index: var(--z-index-base);
  text-align: center;
  line-height: 16px;
  opacity: 0;
  visibility: hidden;
  transform: scaleX(0);
  transform-origin: left;
  overflow: hidden;
  transition: opacity var(--base-transition), transform var(--base-transition), visibility var(--base-transition), background-color var(--base-transition), color var(--base-transition);
}

#position:hover + #categories,
#categories:hover {
  opacity: 1;
  visibility: visible;
  transform: scaleX(1);
  background-color: rgba(0, 0, 0, 1);
  color: rgba(255, 255, 255, 1);
}

.custom-dark-mode #position:hover + #categories,
.card.nightMode #position:hover + #categories,
.custom-dark-mode #categories:hover,
.card.nightMode #categories:hover {
  background-color: rgba(255, 255, 255, 1);
  color: rgba(0, 0, 0, 1);
  opacity: 1;
  visibility: visible;
  transform: scaleX(1);
}

/* Jitendex Settings */
[data-sc-code] {
  display: inline-block;
  line-height: 1.2 !important;
  vertical-align: top !important;
}

[data-sc-content="glossary"]:last-child {
  margin-bottom: -4px !important;
}

[data-sc-content="example-sentence"],
[data-sc-content="antonym"],
[data-sc-content="sense-note"],
[data-sc-content="xref"] {
  margin-bottom: 0 !important;
}

[data-sc-content="example-sentence-a"],
[data-sc-content="antonym"],
[data-sc-content="sense-note"],
[data-sc-content="xref"] {
  opacity: 0.5;
}

.definition-box ol {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0;
  margin-bottom: 0;
}

.glossary-box li {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-top: 0;
  margin-bottom: 0;
}

[data-sc-content="example-sentence-a"], [data-sc-content="example-sentence-b"] {
  font-size: 1em !important;
}

[data-sc-content="example-sentence"] span {
  background-color: unset !important;
  color: var(--light-mode-highlight) !important;
  font-size: unset !important;
}

.card.nightMode [data-sc-content="example-sentence"] span,
.custom-dark-mode [data-sc-content="example-sentence"] span {
  color: var(--dark-mode-highlight) !important;
}

[data-sc-content="example-sentence"] {
  border-color: rgba(3, 3, 3, 0.5) !important;
  transition: border-color var(--base-transition);
}

[data-sc-content="example-sentence"]:hover {
  border-color: rgba(3, 3, 3, 0.8) !important;
}

.card.nightMode [data-sc-content="example-sentence"],
.custom-dark-mode [data-sc-content="example-sentence"] {
  border-color: rgba(252, 252, 252, 0.5) !important;
  transition: border-color var(--base-transition);
}

.card.nightMode [data-sc-content="example-sentence"]:hover,
.custom-dark-mode [data-sc-content="example-sentence"]:hover {
  border-color: rgba(252, 252, 252, 0.8) !important;
}

[data-sc-content="glossary"] {
  display: flex;
  flex-wrap: wrap;
  padding: 0;
  margin: 0;
}

[data-sc-content="glossary"] li:not(:last-child)::after {
  content: "|";
  color: var(--text-color-muted);
  margin: 0 var(--spacing-ms);
}

.card.nightMode [data-sc-content="glossary"] li:not(:last-child)::after,
.custom-dark-mode [data-sc-content="glossary"] li:not(:last-child)::after {
  color: var(--text-color-muted-dark);
}

[data-sc-content="example-sentence"] rt {
  opacity: 0;
  transition: opacity var(--base-transition);
}

[data-sc-content="example-sentence"]:hover rt {
  opacity: 1;
}

span[data-sc-content="example-keyword"] {
  color: var(--light-mode-highlight) !important;
  text-decoration: none !important;
}

.custom-dark-mode span[data-sc-content="example-keyword"], .card.nightMode span[data-sc-content="example-keyword"] {
  color: var(--dark-mode-highlight) !important;
}

div[data-sc-content="attribution"] {
  display: none;
}

[data-sc-content="forms"]{
  opacity: 0;
  display: none;
  transition: opacity var(--base-transition);
}

[data-sc-content|="forms"]:hover {
  opacity: 1;
  display: none;
}

/* Other Dictionaries */
.dictionary-title {
  line-height: 1;
  font-size: var(--dict-size);
  padding: var(--spacing-sm);
  display: var(--dict-display);
  border-radius: var(--border-radius-ms);
  color: var(--dict-color);
  padding: 0;
}

.definition-box .dictionary-title {
  padding: 0 0 10px;
}

.definition-box .dictionary-title {
  display: var(--definition-title-visibility);
}

.glossary-box .dictionary-title {
  display: var(--glossary-title-visibility);
}

#glossary.yomitan-glossary .example a {
  color: var(--light-mode-highlight);
  text-decoration: none;
}

.custom-dark-mode #glossary.yomitan-glossary .example a, .card.nightMode #glossary.yomitan-glossary .example a {
  color: var(--dark-mode-highlight);
}

#glossary.yomitan-glossary .yomitan-word {
  font-weight: bold;
  color: #333;
}

#glossary.yomitan-glossary .accent {
  font-size: 0.7em;
  vertical-align: super;
  margin-left: 0.25em;
  margin-right: 0.25em;
}

#glossary.yomitan-glossary a {
  color: var(--light-mode-highlight);
}

.custom-dark-mode #glossary.yomitan-glossary a, .card.nightMode #glossary.yomitan-glossary a {
  color: var(--dark-mode-highlight);
}

#glossary.yomitan-glossary img {
  max-width: 100%;
  height: auto;
  vertical-align: middle;
  border: none;
  outline: none;
}

#glossary.yomitan-glossary .example {
  margin-left: 1.5em;
  font-size: 0.9em;
  color: #555;
}

#glossary.yomitan-glossary rt {
  opacity: 0;
  transition: opacity var(--base-transition);
}

#glossary.yomitan-glossary ruby:hover rt {
  opacity: 1;
}

/* Hide Yomitan links that don't work in Anki */
#glossary.yomitan-glossary ul a[href="#"],
#glossary.yomitan-glossary div:has(> a[href="#"]) {
  display: none !important;
}

/* Frequencies */
#frequency {
  position: fixed;
  right: var(--spacing-xxml);
  top: 55px;
  font-family: var(--sans);
  z-index: var(--z-index-base);
}

.freqbt {
  position: fixed;
  top: var(--spacing-md);
  right: var(--spacing-xxml);
  font-size: var(--frequency-size);
  padding: var(--spacing-ms);
  color: var(--text-color-light);
  cursor: pointer;
  transition: color var(--base-transition), text-shadow var(--base-transition);
}

.freqbt:hover {
  color: var(--light-text);
  text-shadow: 0 0 5px var(--light-bg);
}

.frequency-box:hover .freqbt {
  color: var(--light-text);
  text-shadow: 0 0 5px var(--light-bg);
}

.card.nightMode .frequency-box:hover .freqbt,
.custom-dark-mode .frequency-box:hover .freqbt {
  color: var(--dark-text);
  text-shadow: 0 0 5px var(--dark-bg);
}

.custom-dark-mode .freqbt:hover, 
.card.nightMode .freqbt:hover {
  color: var(--dark-text);
  text-shadow: 0 0 5px var(--dark-bg);
}

.custom-dark-mode .freqbt, .card.nightMode .freqbt {
  color: var(--text-color-dark);
}

.frequency-content {
  opacity: 0;
  max-height: 0;
  padding: 0 var(--spacing-lg);
  background: var(--frequency-bg-light);
  border-radius: var(--border-radius-ms);
  color: var(--dark-text);
  font-size: var(--frequency-content-size);
  overflow: hidden;
  transition: opacity var(--base-transition), max-height var(--base-transition), padding var(--base-transition);
  will-change: opacity, max-height, padding;
}

.card.nightMode .frequency-content,
.custom-dark-mode .frequency-content {
  background: var(--frequency-bg-dark);
}

.frequency-box:hover .frequency-content {
  opacity: 1;
  max-height: var(--frequency-max-height);
  padding: var(--spacing-lg);
}

/* Tags */
.tags {
  left: 0px;
  font-size: var(--tag-font-size);
  margin-top: var(--tag-margin-top);
  margin-bottom: var(--tag-margin-bottom);
  padding: var(--tag-padding);
  border-radius: var(--tag-border-radius);
}

.tags-container {
  display: var(--tag-visibility);
  flex-direction: row;
  flex-wrap: wrap;
  gap: var(--tags-container-gap);
  width: 100%;
}

.tags:empty {
  display: none;
}

.card.nightMode .tags, 
.custom-dark-mode .tags {
  background: var(--tag-bg);
  color: var(--tag-color);
}

/* Misc Info */
.misc-info {
  font-family: var(--sans);
  font-size: var(--misc-info-size);
  font-weight: bold;
  width: 100%;
  z-index: var(--z-index-base);
  box-sizing: border-box;
  overflow: hidden;
  max-height: 0;
  padding-bottom: 0;
  transition: max-height var(--base-transition), padding-top var(--base-transition), opacity var(--base-transition);
  display: flex;
  justify-content: center;
  direction: ltr;
  unicode-bidi: normal;
  text-align: left;
}

.misc-info:has(> b) {
  text-align: center;
  display: block;
}

.misc-info b {
  margin: 0 0.25rem;
}

/* Responsive Design */
.mobile .card, .mobile #content {
  margin: 0;
}

.mobile .front::before, 
.mobile .back::before {
  border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg) !important;
}

@media (max-width: 1200px) {
  .grid-container {
    grid-template-columns: var(--grid-columns-large);
  }

  .toggle-custom-dark-mode,
  .audio, .sentenceaudio {
    visibility: var(--button-visibility-large);
    position: absolute;
    left: 25px;
    display: flex;
  }

  .toggle-custom-dark-mode {
    top: 25px;
  }

  .audio {
    top: 66px;
  }

  .sentenceaudio {
    top: 107px;
  }

  .frequency-content {
    display: none;
  }

  #frequency, .freqbt {
    visibility: var(--freq-visibility-large);
    display: flex;
    gap: 5px;
    align-items: center;
    position: absolute;
    top: 5.5px;
    right: 9px;
    z-index: var(--z-index-toggle);
  }

  .glossary-box, .definition-box {
    padding: var(--spacing-md);
  }
}

@media (max-width: 768px) {
  .front { top: 0px; }
  .back { top: 0px; }

  .toggle-custom-dark-mode,
  .audio, .sentenceaudio {
    visibility: var(--button-visibility-medium);
  }

  .grid-container {
    grid-template-columns: var(--grid-columns-medium);
  }

  #frequency, .freqbt {
    visibility: var(--freq-visibility-medium);
  }
}

@media (max-width: 624px) {
  .toggle-custom-dark-mode,
  .audio, .sentenceaudio {
    visibility: var(--button-visibility-small);
  }

  .grid-container {
    grid-template-columns: var(--grid-columns-small);
  }

  #frequency, .freqbt {
    visibility: var(--freq-visibility-small);
  }

  .picture-container {
    max-height: var(--picture-height-small);
  }

  .picture-container img {
    max-height: var(--picture-max-height-small);
  }

  #lightbox {
    display: none;
  }
}
